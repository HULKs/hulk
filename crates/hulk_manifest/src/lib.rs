use std::{path::Path, time::Duration};

use source_analyzer::{
    cyclers::{CyclerKind, Cyclers},
    error::Error,
    manifest::{CyclerManifest, FrameworkManifest},
};

pub fn collect_hulk_cyclers(root: impl AsRef<Path>) -> Result<Cyclers, Error> {
    let manifest = FrameworkManifest {
        cyclers: vec![
            CyclerManifest {
                name: "ObjectDetection",
                kind: CyclerKind::Perception,
                instances: vec![""],
                setup_nodes: vec!["object_detection::image_receiver"],
                nodes: vec![
                    "object_detection::object_detection",
                    // "object_detection::pose_detection",
                    // "object_detection::pose_filter",
                    // "object_detection::pose_interpretation",
                ],
                execution_time_warning_threshold: Some(Duration::from_secs_f32(1.0)),
            },
            CyclerManifest {
                name: "Control",
                kind: CyclerKind::Perception,
                instances: vec![""],
                setup_nodes: vec!["control::sensor_data_receiver"],
                nodes: vec![
                    // "control::active_vision",
                    // "control::ball_filter",
                    // "control::ball_state_composer",
                    // "control::behavior::node",
                    // "control::button_filter",
                    // "control::calibration_controller",
                    // "control::center_of_mass_provider",
                    // "control::dribble_path_planner",
                    // "control::fall_state_estimation",
                    // "control::filtered_game_controller_state_timer",
                    // "control::foot_bumper_filter",
                    // "control::free_kick_signal_filter",
                    // "control::ground_contact_detector",
                    // "control::kick_selector",
                    // "control::led_status",
                    // "control::localization",
                    // "control::motion::animation",
                    // "control::motion::arms_up_squat",
                    // "control::motion::arms_up_stand",
                    // "control::motion::center_jump",
                    "control::motion::command_sender",
                    "control::motion::booster_walking",
                    "control::motion::remote_control",
                    // "control::motion::condition_input_provider",
                    // "control::motion::dispatching_interpolator",
                    // "control::motion::fall_protector",
                    // "control::motion::head_motion",
                    // "control::motion::jump_left",
                    // "control::motion::jump_right",
                    // "control::motion::keeper_jump_left",
                    // "control::motion::keeper_jump_right",
                    // "control::motion::look_around",
                    "control::motion::look_at",
                    "control::motion::motion_selector",
                    // "control::motion::motor_commands_collector",
                    // "control::motion::obstacle_avoiding_arms",
                    // "control::motion::sit_down",
                    // "control::motion::stand_up_back",
                    // "control::motion::stand_up_front",
                    // "control::motion::stand_up_sitting",
                    // "control::motion::step_planner",
                    // "control::motion::wide_stance",
                    // "control::obstacle_filter",
                    // "control::obstacle_receiver",
                    // "control::odometry",
                    // "control::orientation_filter",
                    // "control::penalty_shot_direction_estimation",
                    // "control::primary_state_filter",
                    // "control::ready_signal_detection_filter",
                    // "control::referee_position_provider",
                    // "control::role_assignment",
                    // "control::rule_obstacle_composer",
                    // "control::sacrificial_lamb",
                    // "control::search_suggestor",
                    // "control::sole_pressure_filter",
                    // "control::sonar_filter",
                    // "control::support_foot_estimation",
                    // "control::team_ball_receiver",
                    // "control::time_to_reach_kick_position",
                    // "control::whistle_filter",
                    // "control::world_state_composer",
                    // "control::zero_moment_point_provider",
                ],
                execution_time_warning_threshold: Some(Duration::from_secs_f32(1.0 / 83.0)),
            },
            CyclerManifest {
                name: "HslNetwork",
                kind: CyclerKind::Perception,
                instances: vec![""],
                setup_nodes: vec!["hsl_network::message_receiver"],
                nodes: vec!["hsl_network::message_filter"],
                execution_time_warning_threshold: None,
            },
            CyclerManifest {
                name: "WorldState",
                kind: CyclerKind::RealTime,
                instances: vec![""],
                setup_nodes: vec!["world_state::trigger"],
                nodes: vec![
                    "world_state::ball_filter",
                    "world_state::ball_projector",
                    "world_state::behavior::walk_to_ball",
                    "world_state::camera_matrix_calculator",
                    "world_state::game_controller_filter",
                    "world_state::game_controller_state_filter",
                    "world_state::ground_provider",
                    "world_state::kinematics_provider",
                ],
                execution_time_warning_threshold: Some(Duration::from_secs_f32(1.0 / 83.0)),
            },
            // CyclerManifest {
            //     name: "Audio",
            //     kind: CyclerKind::Perception,
            //     instances: vec![""],
            //     setup_nodes: vec!["audio::microphone_recorder"],
            //     nodes: vec!["audio::whistle_detection"],
            //     execution_time_warning_threshold: None,
            // },
        ],
    };

    Cyclers::try_from_manifest(manifest, root)
}
